<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NFT Case Opener</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #0f0f0f; color: white; font-family: sans-serif; text-align: center; margin: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; }
        
        /* –°—Ç–∏–ª–∏ –∫–µ–π—Å–∞ */
        .case-container { width: 280px; height: 280px; background: #1a1a1a; border: 3px solid #0088cc; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; position: relative; overflow: hidden; }
        .nft-image { width: 80%; height: 80%; object-fit: contain; transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        
        .status { font-size: 1.2rem; margin-bottom: 20px; color: #aaa; }
        .win-name { font-weight: bold; color: #ffcc00; height: 1.5rem; margin-top: 10px; }

        button { background: #0088cc; color: white; border: none; padding: 15px 40px; border-radius: 12px; font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: 0.2s; }
        button:disabled { background: #333; color: #777; }
        
        .balance { position: absolute; top: 20px; font-size: 1.5rem; color: #00ff88; }
    </style>
</head>
<body>

    <div class="balance">üí∞ <span id="coins">0</span></div>

    <div class="case-container" id="case">
        <img src="https://cdn-icons-png.flaticon.com/512/6161/6161301.png" id="nft-display" class="nft-image">
    </div>

    <div class="win-name" id="win-name">–ù–∞–∂–º–∏ "–û—Ç–∫—Ä—ã—Ç—å"</div>
    <p class="status">–°—Ç–æ–∏–º–æ—Å—Ç—å: 50 –º–æ–Ω–µ—Ç</p>

    <button id="open-btn" onclick="openCase()">–û–¢–ö–†–´–¢–¨ –ö–ï–ô–°</button>

    <script>
        const tg = window.Telegram.WebApp;
        let balance = 1000; // –ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –¥–ª—è —Ç–µ—Å—Ç–∞
        document.getElementById('coins').innerText = balance;

        // –í—Ä–µ–º–µ–Ω–Ω—ã–µ NFT (–∑–∞–º–µ–Ω–∏–º –Ω–∞ —Ç–≤–æ–∏ –ø–æ–∑–∂–µ)
        const nfts = [
            { name: "Common NFT", img: "https://cdn-icons-png.flaticon.com/512/9306/9306630.png", chance: 0.6 },
            { name: "Rare Cyber Punk", img: "https://cdn-icons-png.flaticon.com/512/9306/9306622.png", chance: 0.3 },
            { name: "LEGENDARY APE", img: "https://cdn-icons-png.flaticon.com/512/9306/9306614.png", chance: 0.1 }
        ];

        function openCase() {
            if (balance < 50) {
                tg.showAlert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!");
                return;
            }

            balance -= 50;
            document.getElementById('coins').innerText = balance;
            
            const btn = document.getElementById('open-btn');
            const display = document.getElementById('nft-display');
            const nameLabel = document.getElementById('win-name');

            btn.disabled = true;
            nameLabel.innerText = "–û—Ç–∫—Ä—ã–≤–∞–µ–º...";
            tg.HapticFeedback.notificationOccurred('warning');

            // –ê–Ω–∏–º–∞—Ü–∏—è –∫—Ä—É—Ç–∏–ª–∫–∏ (–∏–º–∏—Ç–∞—Ü–∏—è)
            let timer = 0;
            let interval = setInterval(() => {
                const randomNft = nfts[Math.floor(Math.random() * nfts.length)];
                display.src = randomNft.img;
                timer += 100;
                if (timer >= 2000) {
                    clearInterval(interval);
                    finalizeWin();
                }
            }, 100);

            function finalizeWin() {
                // –õ–æ–≥–∏–∫–∞ —à–∞–Ω—Å–æ–≤
                const rand = Math.random();
                let win;
                if (rand < 0.1) win = nfts[2];      // 10% –ª–µ–≥–µ–Ω–¥–∞—Ä–∫–∞
                else if (rand < 0.4) win = nfts[1]; // 30% —Ä–∞—Ä–∫–∞
                else win = nfts[0];                // –æ—Å—Ç–∞–ª—å–Ω—ã–µ 60%

                display.src = win.img;
                nameLabel.innerText = `–í–´–ë–ò–¢–û: ${win.name}`;
                btn.disabled = false;
                tg.HapticFeedback.notificationOccurred('success');
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–æ—Ç—É (–Ω–∞–∑–≤–∞–Ω–∏–µ NFT)
                tg.sendData(`–í—ã–±–∏—Ç: ${win.name}`);
            }
        }
    </script>
</body>
</html>
